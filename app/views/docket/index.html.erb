<div class="page-header">
	<h1>My Docket</h1>
</div>

<% @days_of_this_week.each do |day| %>
<div class="panel panel-default">
	<div class="panel-heading">
		<div class="row">
			<div class="col-md-8">
				<b><%= Date::DAYNAMES[day.wday] %></b>, the <b><%= day.mday.ordinalize %></b> of <b><%= Date::MONTHNAMES[day.month] %></b>
			</div>

			<% day_assignments = current_user.day_assignments(day) %>
			<% day_exams = current_user.day_exams(day) %>
			<% day_assignments_and_exams = day_assignments + day_exams %>
			<% day_events = current_user.day_events(day) %>

			<% day_items = day_assignments + day_exams + day_events %>

			<div class="col-md-4">
				<span class="badge"><%= day_assignments.count %></span>
				<span class="badge"><%= day_exams.count %></span>
				<span class="badge"><%= day_events.count %></span>

				~

				<span class="badge"><%= day_items.count %></span>
			</div>
		</div>
	</div>

	<div class="panel-body row">
		<div class="col-xs-8">
			<div class="row">
				<% if day_exams.count == 0 %>
					<div class="col-xs-12"><b>No exams.</b></div>
				<% else %>
					<div class="col-xs-12"><b>Exams:</b></div>
					<% current_user.classes_with_exams_on(day).sort! { |first, last| first.period <=> last.period }.each do |classroom| %>
						<div class="col-xs-0"><!-- Spacing --></div>
						<div class="col-xs-12">
							<b><%= link_to classroom.course_name, classroom, class: "link-no-underline" %>:</b>
						</div>
						<% classroom_day_exams = classroom.day_exams(day) %>
						<% classroom_day_exams.each do |exam| %>
						   <div class="col-xs-1"><!-- Spacing --></div>
						   <div class="col-xs-11">
							   <%= link_to exam.name, exam, class: "link-no-underline" %>
						   </div>
						   <% end %>
					<% end %>
				<% end %>
			</div>

			<hr class="hr-less-padding" />

			<div class="row">
				<% if day_assignments.count == 0 %>
					<div class="col-xs-12"><b>No assignments.</b></div>
				<% else %>
					<div class="col-xs-12"><b>Assignments:</b></div>
					<% current_user.classes_with_assignments_on(day).sort! { |first, last| first.period <=> last.period }.each do |classroom| %>
						<div class="col-xs-0"><!-- Spacing --></div>
						<div class="col-xs-12">
							<b><%= link_to classroom.course_name, classroom, class: "link-no-underline" %></b>
						</div>
						<% classroom_day_assignments = classroom.day_assignments(day) %>
						<% classroom_day_assignments.each do |assignment| %>
							<div class="col-xs-1"><!-- Spacing --></div>
							<div class="col-xs-11">
								<%= link_to assignment.name, assignment, class: "link-no-underline" %> is due today.
							</div>
						<% end %>
					<% end %>
				<% end %>
			</div>
		</div>

		<div class="col-xs-4">
			<% if day_events.count == 0 %>
				No events.
			<% else %>
				<div class="row">
				<% day_events.each do |event| %>
					<div class="col-xs-12">
						<%= link_to event.name, event, class: "link-no-underline" %> @ <%= event.date.strftime("%H:%M") %>
					</div>
				<% end %>
				</div>
			<% end %>
		</div>
	</div>
</div>
<% end %>
